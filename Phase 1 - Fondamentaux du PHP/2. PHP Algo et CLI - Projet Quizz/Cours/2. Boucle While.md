# La boucle while

https://www.w3schools.com/php/php_looping.asp

> Voir `while` sur w3s : https://www.w3schools.com/php/php_looping_while.asp

La boucle while fonctionne comme le if mais exécute son bloc d'instructions en boucle tant que la condition est vraie.

```php
while (1 == 1) {
    echo "Je suis toujours vrai !!!!\n";
}
```

> Quand vous faite une boucle while assurez vous toujours que la condition de sortie peut être atteinte !

1. Exécutez le programme suivant. Vous avez créé un programme infini ! 
> (Faites *Ctrl+C* dans le terminal pour tuer le processus).


*afficher les nombres de 1 à 5*
```php
$i = 1;
while ($i <= 5) {
    echo "Compteur : $i\n";
    $i = $i + 1;
}
```

*Demander l'âge jusqu'à ce qu'il soit correct*
```php
$age = 0; // J'initialise une variable $age
while ($age <= 0) {
    echo "Quel âge as-tu ?\n";
    $age = trim(fgets(STDIN));
}
echo "Tu as $age !\n";
```

## do...while
Pour simplifier l'algo je peux utiliser `do while` qui vérifie la condition à la fin du bloc d'instructions :
```php
do{
    echo "Quel âge as-tu ?\n";
    $age = trim(fgets(STDIN));
}while($age <= 0);
echo "Tu as $age ans!\n";
```

> `do...while` exécute le bloc au moins une fois, même si la condition est fausse dès le départ, contrairement à while.

> Voir `do while` w3s : https://www.w3schools.com/php/php_looping_do_while.asp

## break et continue

Lors de l'execution d'un boucle il est possible de sortir de la boucle même si la condition est encore vraie.

- `break` : arrete l'execution complete du bloc d'execution et passe la la suite du code (après les accolades du while).
- `continue` : saute l'itération en cours sans attendre que toute les lignes du bloc d'instruction soit executé et passe donc au tour suivant.

```php
<?php
$i = 0;
while ($i < 10) {
    $i++;
    if ($i == 5) continue; // saute l'affichage pour 5
    if ($i == 8) break;    // arrête la boucle à 8
    echo "$i\n";
}
```

Ici le programme affiche :
```
1
2
3
4
6
7
```
Le 5 n'est pas affiché car il est sauté par `continue` et la boucle s'arrête avant d'afficher 8 à cause de `break`.

## Cas d'utilisation : boucle d'événements

La boucle while est très utilisée pour créer des applications qui interagissent avec des actions utilisateur comme les jeux vidéo ou des 

*Un programme qui permet de créer des fichiers nommé en fonction de l'heure*
```php
<?php
while (true) {
    echo "Tapez une commande (create, aide, quitter) :\n";
    $commande = trim(fgets(STDIN)); // trim enlève le retour à la ligne
    
    switch ($commande) {
        case "create":
            echo "Creation du fichier\n";
            $fichier = fopen(date("h:m:s"),"w+");
            break;
        case "aide":
            echo "Commandes disponibles : create, aide, quitter\n";
            break;
        case "quitter":
            echo "Au revoir !\n";
            exit; // arrête l'execution du programme
        default:
            echo "Commande inconnue.\n";
    }
}
```

> Switch est une surcouche d'un if : Voir la doc w3schools : https://www.w3schools.com/php/php_switch.asp

1. Testez le programme précedent, vous devriez voir apparaitre des fichiers en fonction de la commande que vous tapez. 
    - Vous pouvez taper `aide` pour voir les commande et `quitter` pour arreter le programme. Le programme n'est pas très utile en lui même mais permet de comprendre la conception d'une boucle d'évenement.